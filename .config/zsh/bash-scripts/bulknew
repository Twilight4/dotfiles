#!/usr/bin/env sh

# Description: Create multiple files and directories at once
# Supports brace expansion and mixed file/dir creation
# POSIX compliant

EDITOR="${EDITOR:-vi}"
TMPDIR="${TMPDIR:-/tmp}"

tmpfile=$(mktemp "$TMPDIR/.nnnXXXXXX")
$EDITOR "$tmpfile"

# Read each non-empty, non-absolute line
while IFS= read -r line; do
    # Skip empty lines or absolute paths
    [ -z "$line" ] && continue
    case "$line" in
        /*) continue ;;  # skip absolute paths
    esac

    # Expand braces using eval safely
    for path in $(eval "echo $line"); do
        # If path ends with '/', treat as directory
        case "$path" in
            */) mkdir -p "$path" ;;
            *) mkdir -p "$(dirname "$path")" && touch "$path" ;;
        esac
    done
done < "$tmpfile"

rm "$tmpfile"
